# Гостиничный комплекс "Лесной Дворик"

Полноценная система управления гостиничным комплексом, включающая веб-сайт для клиентов и CRM-систему для администраторов.

## Возможности

### Для гостей:
- Просмотр и поиск номеров с фильтрами по датам, вместимости и типу
- Бронирование номеров
- Управление личными бронированиями
- Личный кабинет с историей бронирований

### Для администраторов:
- Полное управление номерами (добавление, редактирование, удаление)
- Управление бронированиями (подтверждение, отмена, просмотр)
- Управление клиентами и их данными
- Аналитика и отчеты (загруженность, популярные номера, доходы)

## Технический стек

### Backend:
- Node.js с Express
- PostgreSQL с Sequelize ORM
- JSON Web Token для аутентификации
- Nodemailer для отправки уведомлений по email

### Frontend:
- React.js с React Router
- Styled Components для стилизации
- Formik и Yup для форм и валидации
- React Datepicker для работы с датами
- Chart.js для отображения аналитики

## Структура проекта

```
/backend
  /config        - конфигурация DB и других сервисов
  /controllers   - логика обработки запросов
  /middlewares   - промежуточное ПО (например, аутентификация)
  /models        - модели данных для ORM
  /routes        - определение API маршрутов

/frontend
  /public        - статические файлы
  /src
    /assets      - изображения, шрифты и т.д.
    /components  - переиспользуемые компоненты React
    /context     - React контексты (например, для аутентификации)
    /hooks       - пользовательские React хуки
    /pages       - компоненты страниц
    /services    - сервисы для взаимодействия с API
    /utils       - вспомогательные функции
```

## Инструкция по запуску на Linux

### Требования

* Node.js (версия 14.x или выше)
* npm (версия 6.x или выше)
* Git

### Шаг 1: Клонирование репозитория

```bash
# Клонировать репозиторий
git clone https://github.com/falconexlover/sitectestoviy.git

# Перейти в директорию проекта
cd sitectestoviy
```

### Шаг 2: Установка зависимостей и запуск Backend

```bash
# Перейти в директорию backend
cd backend

# Установить зависимости
npm install

# Запустить сервер
node server.js

# Или для разработки с автоматическим перезапуском при изменении файлов
# npm install -g nodemon
# nodemon server.js
```

Бэкенд будет запущен на порту 5000 (http://localhost:5000/api)

### Шаг 3: Установка зависимостей и запуск Frontend (в новом терминале)

```bash
# Перейти в директорию frontend (из корня проекта)
cd frontend

# Установить зависимости
npm install

# Запустить приложение в режиме разработки
npm start
```

Фронтенд будет запущен на порту 3000 (http://localhost:3000)

### Шаг 4: Доступ к приложению

После успешного запуска обеих частей проекта:

1. Откройте браузер и перейдите по адресу http://localhost:3000
2. Веб-интерфейс гостиничного комплекса "Лесной Дворик" будет доступен для использования

### Примечания

* Если вы хотите запустить оба сервера (frontend и backend) одновременно, можно использовать пакет concurrently:

```bash
# В корневой директории проекта создать package.json (если его нет)
echo '{"scripts": {"start": "concurrently \"cd backend && node server.js\" \"cd frontend && npm start\""}}' > package.json

# Установить concurrently
npm install --save-dev concurrently

# Запустить оба сервера
npm start
```

* Для работы в production окружении рекомендуется:
  - Собрать frontend: `cd frontend && npm run build`
  - Настроить сервер (например, Nginx) для раздачи статических файлов из директории `frontend/build`
  - Запустить backend через процесс-менеджер, например, PM2: `pm2 start backend/server.js`

### Возможные проблемы и их решение

1. **Порт 3000 или 5000 уже используется**
   ```bash
   # Найти процесс, использующий порт
   sudo lsof -i :3000   # или :5000
   
   # Завершить процесс
   kill -9 <PID>
   ```

2. **Ошибки при установке зависимостей**
   ```bash
   # Очистить кэш npm
   npm cache clean --force
   
   # Повторить установку
   npm install
   ```

3. **Проблемы с правами доступа**
   ```bash
   # Изменить владельца файлов
   sudo chown -R $(whoami) .
   ```

### Контакты для поддержки

При возникновении проблем обращайтесь по email: info@lesnoy-dvorik.ru

## Архитектура базы данных

### Основные таблицы:
- **Users**: пользователи системы (клиенты, администраторы)
- **Rooms**: номера отеля
- **Bookings**: бронирования

## API эндпоинты

### Аутентификация
- POST `/api/auth/register` - регистрация пользователя
- POST `/api/auth/login` - аутентификация пользователя
- GET `/api/auth/profile` - получение профиля пользователя
- PUT `/api/auth/profile` - обновление профиля
- PUT `/api/auth/change-password` - изменение пароля

### Номера
- GET `/api/rooms` - получение всех номеров
- GET `/api/rooms/:id` - получение информации о номере
- GET `/api/rooms/available` - получение доступных номеров на даты
- POST `/api/rooms` - создание номера (только админ)
- PUT `/api/rooms/:id` - обновление номера (только админ)
- DELETE `/api/rooms/:id` - удаление номера (только админ)

### Бронирования
- POST `/api/bookings` - создание бронирования
- GET `/api/bookings` - получение бронирований пользователя
- GET `/api/bookings/:id` - получение информации о бронировании
- PUT `/api/bookings/cancel/:id` - отмена бронирования
- GET `/api/bookings/admin/all` - получение всех бронирований (админ)
- PUT `/api/bookings/admin/status/:id` - изменение статуса бронирования (админ)

### Клиенты (админ)
- GET `/api/customers` - получение всех клиентов
- GET `/api/customers/:id` - получение информации о клиенте
- GET `/api/customers/search` - поиск клиентов
- GET `/api/customers/:id/stats` - статистика по клиенту

### Аналитика (админ)
- GET `/api/analytics/overall` - общая статистика
- GET `/api/analytics/period` - статистика за период
- GET `/api/analytics/forecast` - прогноз загруженности
- GET `/api/analytics/popular-rooms` - популярные номера

## Разработчики

- [Ваше имя] - Ведущий разработчик

## Лицензия

MIT 